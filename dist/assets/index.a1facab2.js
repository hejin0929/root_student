var v=Object.defineProperty;var T=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable;var p=(t,e,a)=>e in t?v(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,b=(t,e)=>{for(var a in e||(e={}))D.call(e,a)&&p(t,a,e[a]);if(T)for(var a of T(e))B.call(e,a)&&p(t,a,e[a]);return t};var o=(t,e,a)=>(p(t,typeof e!="symbol"?e+"":e,a),a);import{m as f,b as L,h as m,T as S,j as l,F as C,o as y,d as g,I as N,B as O}from"./vendor.0d2e9121.js";import{a as w}from"./index.d41693ee.js";import{u as U}from"./index.0be79017.js";import{I as A,l as x}from"./index.46817d03.js";var _;(function(t){t[t.INPUT=1]="INPUT",t[t.SELECTOR=2]="SELECTOR",t[t.PASSWORD=3]="PASSWORD",t[t.NUMBER=4]="NUMBER",t[t.INPUT_TEXT=5]="INPUT_TEXT",t[t.DATE_PICKER=6]="DATE_PICKER",t[t.INPUT_NUMBER=7]="INPUT_NUMBER"})(_||(_={}));class R{constructor({events:e}){o(this,"events");o(this,"call");e.on("init",a=>{!a||this.updateData({call:a.onSubmit})}),this.updateData({events:e}),f(this)}handleSubmit(e){var a,i;this.call&&((a=this.call)==null||a.call(this,e)),(i=this.events)==null||i.subscribe("formSubmit",e)}updateData(e){L(()=>{Object.assign(this,e)})}}const I="LOGIN",M="NEW USER",P="new user",k="system language",H="login",G="code login",j="password login";var W={logo:I,user:M,newUser:P,systemLanguage:k,login:H,codeLogin:G,passwordLogin:j};const $="\u6B22\u8FCE\u767B\u9646",Z="\u65B0\u7528\u6237",q="\u6211\u662F\u65B0\u7528\u6237",F="\u8BED\u8A00\u8BBE\u7F6E",J="\u767B\u9646",z="\u9A8C\u8BC1\u7801\u767B\u9646",K="\u5BC6\u7801\u767B\u9646";var X={logo:$,user:Z,newUser:q,systemLanguage:F,login:J,codeLogin:z,passwordLogin:K};class V{constructor(){o(this,"select","ZH_CN");f(this)}get selectList(){return this.select==="ZH_CN"?[{name:"\u4E2D\u6587",value:"ZH_CN"},{name:"\u82F1\u6587",value:"EM_US"}]:[{name:"Chinese",value:"ZH_CN"},{name:"English",value:"EM_US"}]}updateNames(e){this.select=e}get names(){return this.select==="ZH_CN"?JSON.parse(JSON.stringify(X)):JSON.parse(JSON.stringify(W))}}const d=new V;var u;(function(t){t[t.PASSWORD_LOGIN=1]="PASSWORD_LOGIN",t[t.CODE_LOGIN=2]="CODE_LOGIN",t[t.ADD_USER=3]="ADD_USER",t[t.GET_CODE=4]="GET_CODE"})(u||(u={}));class Q{constructor({events:e,routers:a,user:i}){o(this,"isCode",!1);o(this,"isPassword",!1);o(this,"count");o(this,"times");o(this,"oldPhone",[]);o(this,"pageStyleType",1);o(this,"router");o(this,"user");o(this,"formList",[{name:"\u624B\u673A:",value:"phone",isShow:!0,rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\u7801!!!"}],type:_.INPUT},{name:"\u9A8C\u8BC1\u7801:",value:"code",isShow:!1,rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801!!!"}],type:_.INPUT},{name:"\u5BC6\u7801:",value:"password",isShow:!0,rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801!!!"}],type:_.PASSWORD}]);o(this,"$$");o(this,"test");this.$$=e,this.router=a,this.user=i,f(this),this.$$.on("password",n=>{if(n.length>5)return this.UpdateData({isPassword:!0});this.UpdateData({isPassword:!1})}),this.$$.on("phone",n=>{var r,s;if(n.length>10){if((r=this.oldPhone)==null?void 0:r.includes(n))return;(s=this.oldPhone)==null||s.push(n),this.UpdateData({isPassword:!1,isCode:!1})}}),e==null||e.on("name",n=>{this.UpdateData({isCode:!1})})}get pageFormLogin(){return this.formList.filter(e=>e.isShow)}get viewText(){return this.pageStyleType===3?m({[this.count+"s"]:this.count&&!this.isCode,\u83B7\u53D6\u9A8C\u8BC1\u7801:!this.count,\u786E\u8BA4\u6CE8\u518C:this.isCode}):m({[this.count+"s"]:this.count&&!this.isCode,\u83B7\u53D6\u9A8C\u8BC1\u7801:!this.isCode&&!this.count&&this.viewLoginType==="\u5BC6\u7801\u767B\u9646",\u786E\u8BA4\u767B\u9646:!this.count&&this.viewLoginType==="\u9A8C\u8BC1\u7801\u767B\u9646",\u786E\u8BA4\u5BC6\u7801:this.isCode})}get viewTitleText(){return m({[d.names.logo]:this.pageStyleType===1||this.pageStyleType===2,[d.names.user]:this.pageStyleType===3})}get viewTitleLeftText(){return m({[d.names.newUser]:this.pageStyleType===1||this.pageStyleType===2,[d.names.login]:this.pageStyleType===3})}get viewLoginType(){return m({[d.names.codeLogin]:this.pageStyleType===1,[d.names.passwordLogin]:this.pageStyleType===2})}handleAddUser(e){w("/api/login/user/sign",{params:void 0,method:"post",reqData:e}).then(a=>{S.show({content:"\u6CE8\u518C\u6210\u529F"})})}handleChange(e){Object.keys(e).indexOf("code")!==-1&&this.UpdateData({isCode:e.code!=="",formList:this.formList.map(i=>(i.value==="password"&&(i.isShow=e.code!==""),i))})}getCode(e){this.times&&clearTimeout(this.times),w("/api/phone_code/user/{phone}",{params:{phone:e||""},method:"get",reqData:void 0}).then(a=>{const i=this.formList.map(n=>{var s;const r=b({},n);return r.value==="code"&&(r.default=(s=a.body)==null?void 0:s.code,r.isShow=!0),b({},r)});this.UpdateData({isCode:!0,count:60,formList:i}),this.times=setInterval(()=>{this.UpdateData({count:this.count&&this.count-1}),this.count===0&&this.times&&(this.UpdateData({isCode:!1}),clearTimeout(this.times))},1e3)})}async loginUser(e){var i,n,r,s;const a=await w("/api/login/user/login",{reqData:e,method:"post",params:void 0});return a.mgsCode===200?(localStorage.setItem("token",((i=a.body)==null?void 0:i.token)||""),localStorage.setItem("uuid",((n=a.body)==null?void 0:n.id)||""),(r=this.user)==null||r.initUpdate(),S.show({content:a.mgsText,icon:"success"}),(s=this.router)==null?void 0:s.navigate("/home/1")):S.show({content:a.mgsText,icon:"fail"})}handleOnSubmit(e){if(this.pageStyleType===3&&this.viewText==="\u83B7\u53D6\u9A8C\u8BC1\u7801")this.getCode(e.phone);else{if(this.viewText==="\u786E\u8BA4\u767B\u9646")return this.loginUser(e);this.viewText==="\u786E\u8BA4\u6CE8\u518C"&&this.handleAddUser(e)}}handleUpdateStyleType(e){switch(this.formList.forEach(a=>a.isShow=!0),e){case 1:this.formList[1].isShow=!1;break;case 2:this.formList[2].isShow=!1;break;case 4:this.formList[1].isShow=!1,this.formList[2].isShow=!1;break;case 3:this.formList[2].isShow=!1,this.formList[1].isShow=!1}this.UpdateData({pageStyleType:e})}UpdateData(e){var a;for(let i in e)(a=this.$$)==null||a.subscribe(i,e[i]);L(()=>{Object.assign(this,e)})}}const Y="_SignBox_14li5_1",ee="_signTitle_14li5_8",te="_textRight_14li5_14",ae="_language_14li5_20",se="_loginImg_14li5_26",ie="_formMains_14li5_33",ne="_loginType_14li5_36",oe="_IC_Order_14li5_41",le="_HomeMain_14li5_1",re="_homeHeader_14li5_1",de="_leftBlock_14li5_1",ue="_rootRender_14li5_1",ce="_rootCanvas_14li5_1";var c={SignBox:Y,signTitle:ee,textRight:te,language:ae,loginImg:se,formMains:ie,loginType:ne,IC_Order:oe,"_adm-px-tester_a9z67_1":"__adm-px-tester_a9z67_1_14li5_1","adm-avatar":"_adm-avatar_14li5_1","adm-action-sheet-popup":"_adm-action-sheet-popup_14li5_1","adm-popup-body":"_adm-popup-body_14li5_1","adm-action-sheet-extra":"_adm-action-sheet-extra_14li5_1","adm-action-sheet-button-item-wrapper":"_adm-action-sheet-button-item-wrapper_14li5_1","adm-action-sheet-button-item":"_adm-action-sheet-button-item_14li5_1","adm-action-sheet-button-item-name":"_adm-action-sheet-button-item-name_14li5_1","adm-action-sheet-button-item-description":"_adm-action-sheet-button-item-description_14li5_1","adm-action-sheet-cancel":"_adm-action-sheet-cancel_14li5_1","adm-button":"_adm-button_14li5_1","adm-button-default":"_adm-button-default_14li5_1","adm-button-fill-none":"_adm-button-fill-none_14li5_1","adm-button-mini":"_adm-button-mini_14li5_1","adm-button-shape-rounded":"_adm-button-shape-rounded_14li5_1","adm-button-small":"_adm-button-small_14li5_1","adm-button-large":"_adm-button-large_14li5_1","adm-capsule-tabs-header":"_adm-capsule-tabs-header_14li5_1","adm-capsule-tabs-tab-wrapper":"_adm-capsule-tabs-tab-wrapper_14li5_1","adm-capsule-tabs-tab":"_adm-capsule-tabs-tab_14li5_1","adm-capsule-tabs-content":"_adm-capsule-tabs-content_14li5_1","adm-capsule-tabs-header-mask":"_adm-capsule-tabs-header-mask_14li5_1","adm-badge":"_adm-badge_14li5_1","adm-badge-content":"_adm-badge-content_14li5_1","adm-badge-dot":"_adm-badge-dot_14li5_1","adm-badge-bordered":"_adm-badge-bordered_14li5_1","adm-calendar":"_adm-calendar_14li5_1","adm-calendar-header":"_adm-calendar-header_14li5_1","adm-calendar-arrow-button":"_adm-calendar-arrow-button_14li5_1","adm-calendar-title":"_adm-calendar-title_14li5_1","adm-calendar-cells":"_adm-calendar-cells_14li5_1","adm-calendar-cell":"_adm-calendar-cell_14li5_1","adm-calendar-cell-selected":"_adm-calendar-cell-selected_14li5_1","adm-calendar-cell-selected-begin":"_adm-calendar-cell-selected-begin_14li5_1","adm-calendar-cell-selected-end":"_adm-calendar-cell-selected-end_14li5_1","adm-calendar-cell-top":"_adm-calendar-cell-top_14li5_1","adm-calendar-cell-bottom":"_adm-calendar-cell-bottom_14li5_1","adm-calendar-mark":"_adm-calendar-mark_14li5_1",HomeMain:le,homeHeader:re,leftBlock:de,rootRender:ue,rootCanvas:ce};const E=({v:t,children:e})=>l(C.Item,{name:t.value,label:t.name,rules:t.rules,children:e},t.value),_e="_formMain_hdpxw_1";var me={formMain:_e};const he=t=>{const{list:e,submitTxt:a="\u786E\u8BA4",onSubmit:i,onChange:n}=t,r=U(R,{onSubmit:i,list:e});return l("div",{className:me.formMain,children:g(C,{onFinish:s=>r.handleSubmit(s),initialValues:(()=>{const s={};return e.forEach(h=>{s[h.value]=h.default}),s})(),children:[e.map(s=>{switch(s.type){case _.INPUT:return l(E,{v:s,children:l(N,{placeholder:s.placeholder,onChange:h=>n==null?void 0:n({[s.value]:h})})},s.value);case _.PASSWORD:return l(E,{v:s,children:l(N,{placeholder:s.placeholder,type:"password"})},s.value)}}),l(C.Item,{children:l(O,{color:"primary",type:"submit",size:"large",children:a})})]})})};var ge=y(he);const pe=()=>{const t=U(Q);return g("div",{className:c.SignBox,children:[g("h2",{className:c.signTitle,children:[l("span",{className:c.language,onClick:()=>d.updateNames(d.select==="EM_US"?"ZH_CN":"EM_US"),children:d.names.systemLanguage}),t.viewTitleText," ",l("span",{className:c.textRight,onClick:()=>t.handleUpdateStyleType(t.pageStyleType===u.ADD_USER?u.PASSWORD_LOGIN:u.ADD_USER),children:t.viewTitleLeftText})]}),l("div",{className:c.loginImg,children:l(A,{url:x})}),g("div",{className:c.formMains,children:[l(ge,{list:t.pageFormLogin,onSubmit:e=>t.handleOnSubmit(e),submitTxt:t.viewText,onChange:e=>{t.handleChange(e)}}),l("div",{className:c.loginType,onClick:()=>t.handleUpdateStyleType(t.pageStyleType===u.PASSWORD_LOGIN?u.CODE_LOGIN:u.PASSWORD_LOGIN),children:t.viewLoginType})]}),l("a",{className:c.IC_Order,href:"https://beian.miit.gov.cn/",children:"\u7CA4ICP\u59072021160767\u53F7"})]})};var Te=y(pe);export{Te as default};
